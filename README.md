# Blue Team Homelab: Endpoint Security with Elastic SIEM & EDR

This project documents the creation and operation of a cybersecurity homelab designed to simulate a real-world Security Operations Center (SOC) workflow. A virtualized Windows 10 endpoint was integrated with a full Elastic Security stack, including Elastic SIEM for log aggregation and Elastic Defend for Endpoint Detection and Response (EDR).

The goal was to demonstrate an end-to-end process for endpoint protection, from telemetry ingestion and malware detection to incident triage and dashboard visualization.

---
## The Incident Response Workflow

The core of this project was to follow a realistic incident response lifecycle. A malware threat was simulated on the protected endpoint to validate the effectiveness of the security stack.

### Step 1: The Initial Alert (Real-Time Malware Detection)
The validation test began by downloading an EICAR test file to the Windows 10 VM. The **Elastic Defend** agent immediately identified the file as malware, blocked the operation, and generated a high-severity alert (Risk Score 73) in the SIEM. This confirmed a 100% detection and prevention rate for the simulated threat.

<img src="./assets/Malware Detection.png" width="800" alt="Elastic Security alert showing malware prevention for an EICAR test file">
*<p align="center">Figure 1: The real-time malware prevention alert generated by Elastic Defend.</p>*

### Step 2: The Investigation (Process Tracing)
Following the alert, I pivoted to an analyst role to investigate the incident's origin. Using Elastic's **Session Analyzer**, I performed a deep-dive process trace on the event. This visualization provided a clear process tree, showing how the parent process (`explorer.exe`) spawned the web browser (`msedge.exe`), which then wrote the malicious file. This level of detail is critical for root cause analysis and understanding attack chains.

<img src="./assets/Process Tree.png" width="800" alt="Session analyzer view showing the process tree for the malware event">
*<p align="center">Figure 2: The process tree visualization, tracing the malware back to its parent processes.</p>*

### Step 3: The Big Picture (Dashboard Monitoring)
Beyond individual alerts, a SOC requires high-level situational awareness. I built a custom **Kibana dashboard** to provide at-a-glance visibility into critical security events across the environment. The dashboard includes visualizations for administrator logins, system event spikes, and unique host IP interactions, allowing an analyst to spot trends and anomalies.

<img src="./assets/Host and Event Timeline.png" width="800" alt="Custom Kibana dashboard showing security event timelines and host data">
*<p align="center">Figure 3: The custom security dashboard for high-level event monitoring.</p>*

---
## Skills & Technologies Demonstrated

* **Elastic SIEM:** Log ingestion, data analysis, and security event management.
* **Elastic Defend (EDR):** Endpoint agent deployment, malware prevention, and process monitoring.
* **Kibana:** Building custom dashboards and visualizations for security monitoring.
* **Incident Response:** Following a structured triage workflow from alert to investigation and reporting.
* **Threat Simulation:** Using standard testing methodologies (EICAR) to validate security controls.
* **Log Analysis:** Querying and interpreting endpoint logs to understand system and user activity.
